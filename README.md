# NetWorkingCapital

## Описание

**NetWorkingCapital** — это интерактивное веб-приложение для расширенного анализа Чистого Оборотного Капитала (ЧОК, Net Working Capital, NWC) компании. Приложение позволяет быстро и удобно анализировать структуру ЧОК, оценивать точность прогнозов по статьям, выявлять наиболее значимые и чувствительные компоненты, а также формировать отчёты для принятия управленческих решений.

## Для кого это приложение

- Финансовые директора и аналитики
- Руководители планово-экономических отделов
- Бизнес-аналитики и контролёры
- Консультанты по управлению финансами

## Какие бизнес-проблемы решает

- **Контроль ликвидности:** Помогает понять, достаточно ли у компании оборотных активов для покрытия краткосрочных обязательств.
- **Анализ структуры ЧОК:** Позволяет выявить, какие статьи оказывают наибольшее влияние на итоговый показатель.
- **Оценка точности прогнозов:** Сравнивает прогнозные значения с фактическими, выявляет ошибки и зоны риска.
- **Приоритизация усилий:** Определяет, на какие статьи стоит обратить особое внимание при планировании и прогнозировании.
- **Автоматизация расчётов:** Упрощает подготовку аналитических отчётов и экспорт данных в Excel.

## Ключевые возможности

- Загрузка собственных Excel-файлов с данными или использование встроенных демонстрационных данных.
- Автоматическое определение фактических и прогнозных периодов по ключевым словам в названиях столбцов.
- Расчёт итоговых показателей по периодам: Итого ОА, Итого КО, ЧОК.
- **Анализ существенности статей ЧОК с использованием трёх методов:**
    - **`vs_CHOK` (рычаг влияния):** Рассчитывается как `(|Статья| / |ЧОК периода|) * 100%`. Показывает, насколько сильно изменение конкретной статьи влияет на общий ЧОК. Сумма процентов по всем статьям может быть больше 100%, так как некоторые статьи могут иметь разнонаправленное влияние или компенсировать друг друга. Высокий процент указывает на значительный "рычаг" статьи.
    - **`vs_TotalComponents` (доля в общем объеме):** Рассчитывается как `(|Статья| / Сумма_модулей_всех_статей_ОА_и_КО_периода|) * 100%`. Показывает долю каждой статьи в общем объеме (по модулю) всех компонентов ЧОК (и оборотных активов, и краткосрочных обязательств). Сумма процентов по всем статьям равна 100%. Помогает понять "вес" каждой статьи в общей массе.
    - **`within_OA_CO` (структура ОА/КО):** Рассчитывается отдельно для оборотных активов (`(|Статья ОА| / |Итого ОА|) * 100%`) и краткосрочных обязательств (`(|Статья КО| / |Итого КО|) * 100%`). Показывает структуру (внутренний состав) оборотных активов и краткосрочных обязательств. Сумма процентов по статьям ОА равна 100% от Итого ОА, и аналогично для КО. Помогает выявить ключевые компоненты внутри каждой группы.
- Анализ точности прогнозов (абсолютные и относительные отклонения).
- Оценка чувствительности ЧОК к ошибкам в прогнозах отдельных статей.
- Экспорт всех расчётов в единый Excel-файл.
- Подробные пояснения и рекомендации по интерпретации результатов.

## Как работает приложение

1. **Загрузка данных:** Вы можете загрузить свой Excel-файл с данными по статьям ЧОК или воспользоваться демо-данными.
2. **Настройка анализа:** В боковой панели выбираются периоды, методы анализа, лимиты отклонений и другие параметры.
3. **Анализ и визуализация:** Приложение автоматически рассчитывает ключевые показатели, строит таблицы и поясняет результаты.
4. **Экспорт:** Все результаты можно выгрузить в Excel для дальнейшей работы или презентации.

## Преимущества

- Не требует навыков программирования или сложных настроек.
- Гибкая структура данных: поддержка любых периодов и статей.
- Подходит для регулярного мониторинга и ad-hoc анализа.
- Экономит время на подготовку аналитики и снижает риск ошибок ручных расчётов.
- Помогает принимать обоснованные решения по управлению оборотным капиталом.

## Требования

- Python 3.11
- pip (установщик пакетов Python)

## Установка и запуск

1. **Клонируйте репозиторий или скачайте исходный код:**
   ```
   git clone https://github.com/your-org/NetWorkingCapital.git
   cd NetWorkingCapital
   ```

2. **Создайте и активируйте виртуальное окружение (рекомендуется):**
   ```
   python3.11 -m venv venv
   # Для Windows:
   venv\Scripts\activate
   # Для Linux/Mac:
   source venv/bin/activate
   ```

3. **Установите необходимые зависимости:**
   ```
   pip install -r requirements.txt
   ```
   > Если файла `requirements.txt` нет, установите вручную:
   ```
   pip install streamlit pandas numpy xlsxwriter openpyxl
   ```

4. **Запустите приложение:**
   ```
   streamlit run app.py
   ```

5. **Откройте браузер и перейдите по адресу:**
   ```
   http://localhost:8501
   ```

## Формат входных данных

- Подробная инструкция по формату Excel-файла и шаблон для загрузки доступны в самом приложении (боковая панель).

## Обратная связь и поддержка

Если у вас есть вопросы, предложения или вы нашли ошибку — создайте issue в репозитории или напишите на [mihnin@gmail.com].

---

**NetWorkingCapital** — ваш инструмент для эффективного управления оборотным капиталом!
